if("undefined"==typeof jQuery)throw new Error("StrokePainter requires jQuery");if("undefined"==typeof Raphael)throw new Error("StrokePainter requires Raphael");!function(t,e,o){var i=function(t,e){return new i.fn.init(t,e)};t.extend(i,{opts:{width:1024,height:768},tools:{},addTool:function(t,e){this.tools[t]=e}}),i.fn=i.prototype={constructor:i,init:function(o,n){var a=this;return a.context||!o?a:(a.context=t("#"+o),a.context.empty(),a.opts=t.extend(i.opts,n),a.paper=e(o,a.opts.width,a.opts.height),a.canvas=t(a.paper.canvas),a.panel=t(a.opts.panel.html()).appendTo(a.context),a.opts.tools&&a.opts.tools.length>0?t.each(a.opts.tools,function(t,e){a.register(e,i.tools[e]),a.activatedTool||a.active(e)}):t.each(i.tools,function(t,e){a.register(t,e),a.activatedTool||a.active(t)}),a.canvas.on("click",function(){a.activatedTool&&a.activatedTool.click&&a.activatedTool.click.apply(a.activatedTool,arguments)}).on("mousedown",function(){a.activatedTool&&a.activatedTool.mousedown&&a.activatedTool.mousedown.apply(a.activatedTool,arguments)}).on("mouseup",function(){a.activatedTool&&a.activatedTool.mouseup&&a.activatedTool.mouseup.apply(a.activatedTool,arguments)}).on("dbclick",function(){a.activatedTool&&a.activatedTool.dbclick&&a.activatedTool.dbclick.apply(a.activatedTool,arguments)}),this)}},i.fn.init.prototype=i.fn,t.extend(i.fn,{tools:{},register:function(e,o){t.isFunction(o)?this.tools[e]=o(this):console.warn("Tool: "+e+" not found!")},active:function(e){this.activatedTool&&e===this.activatedTool.name||(this.deactive(),this.activatedTool=this.tools[e],this.activatedTool&&t.isFunction(this.activatedTool.activated)&&this.activatedTool.activated())},deactive:function(){this.activatedTool&&t.isFunction(this.activatedTool.deactivated)&&this.activatedTool.deactivated(),this.activatedTool=""}}),o.SP=o.StrokePainter=i}(jQuery,Raphael,window),function(t,e){var o=function(t){return new o.fn.init(t)};o.fn=o.prototype={constructor:o,name:"brush",init:function(e){var o=this;o.painter=e,o.icon=t('<a class="sp-panel-icon" href="javascript:;"><svg class="icon-pencil"><use xlink:href="#icon-pencil"></use></svg></a>'),e.panel.find(".sp-panel-content").append(o.icon),o.icon.on("click",function(){o.icon.is(".active")?o.painter.deactive("brush"):o.painter.active("brush")})}},o.fn.init.prototype=o.fn,t.extend(o.fn,{activated:function(){this.icon.addClass("active")},deactivated:function(){this.painter.canvas.off(".strokepainter.brush"),this.icon.removeClass("active")},mousedown:function(t){if(!this.painting){var e=this;this.painting=!0;var o,i=["M",t.offsetX,t.offsetY];this.painter.canvas.on("mousemove.strokepainter.brush",function(t){i.push("L"),i.push(t.offsetX),i.push(t.offsetY),o||(o=e.painter.paper.path().attr({stroke:"#000","stroke-width":2,path:i})),o.attr({path:i})})}},mouseup:function(){this.painting&&(this.painting=!1,this.painter.canvas.off("mousemove.strokepainter.brush"))}}),e.addTool("brush",o)}(jQuery,StrokePainter),function(t,e){var o=function(){};e.addTool("chooser",o)}(jQuery,StrokePainter),function(t,e){var o=function(t){return new o.fn.init(t)};o.fn=o.prototype={constructor:o,name:"preview",init:function(e){var o=this;o.painter=e,o.icon=t('<a class="sp-panel-icon" href="javascript:;"><svg class="icon-eye"><use xlink:href="#icon-eye"></use></svg></a>'),e.panel.find(".sp-panel-content").append(o.icon),o.icon.click(function(){console.log(o.painter.canvas[0].outerHTML),o.painter.active("preview");var t=o.painter.canvas.find("path");t.each(function(){var t=this.getTotalLength();this.style.transition=this.style.WebkitTransition="none",this.style.strokeDasharray=t+" "+t,this.style.strokeDashoffset=t,this.getBoundingClientRect(),this.style.transition=this.style.WebkitTransition="stroke-dashoffset 2s ease-in-out",this.style.strokeDashoffset="0"}),o.painter.deactive("preview")})}},o.fn.init.prototype=o.fn,t.extend(o.fn,{activated:function(){this.icon.addClass("active")},deactivated:function(){this.icon.removeClass("active")}}),e.addTool("preview",o)}(jQuery,StrokePainter);